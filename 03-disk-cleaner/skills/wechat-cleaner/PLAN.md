# WeChat Cleaner (macOS) - 功能规划

> 目标：用“分析 + 引导 + 备份 + 决策删除”的方式整理微信媒体文件，默认不自动删除。

## 设计原则

- **安全优先**：默认只分析与引导，不执行删除
- **高价值优先**：先识别可备份的聊天媒体，再进入清理决策
- **分层决策**：按时间与类型分层输出，降低误删风险
- **可回溯**：备份有结构、有索引，便于检索
- **可解释**：报告清晰说明“为什么建议清理”

---

## 核心流程

1. **扫描**：识别微信媒体目录、分类与时间分布
2. **报告**：输出占用总览 + 风险分级 + 建议动作
3. **Smart Folder 引导**：生成按时间/类型筛选的智能文件夹
4. **备份**：用户选择要备份的范围，工具执行分类归档
5. **删除（可选）**：用户明确确认后，按清单移入废纸篓

---

## 扫描范围与分类

**微信路径（macOS）**
```
~/Library/Containers/com.tencent.xinWeChat/Data/Library/Application Support/
```

**分类策略**
- 缩略图/临时缓存（低风险）
- 聊天图片（中风险）
- 聊天视频（中高风险）
- 聊天文件（高价值/高风险）

**时间分层**
- > 1 年
- 6-12 个月
- 3-6 个月
- 近 3 个月

**大小分层（用于输出）**
- > 500MB
- 100-500MB
- 10-100MB

---

## 报告输出（默认）

**报告内容**
- 总占用空间
- 按类型占用（图片/视频/文件/缩略图）
- 按时间分布（>1年、6-12月、3-6月、近3月）
- 可释放空间估计（按风险分级）

**风险分级（建议）**
- 绿：缩略图/临时缓存
- 黄：聊天媒体（>1年）
- 红：近期媒体/未备份文件

---

## Smart Folder 引导

**策略说明**
- Smart Folder 用于“先看再决定”，名称由第一轮扫描结果动态生成  
- 命名强调“引导与建议”，避免死规则（例如突出时间段/体积/类型）  
- 统一命名前缀，提供“清理已生成 Smart Folder”选项

**示例命名（按首轮扫描结果生成）**
- `WeChat-旧媒体-1年以上(12.4GB)`
- `WeChat-视频-6~12个月(4.1GB)`
- `WeChat-聊天文件-高价值待备份`

---

## 备份与组织（高价值优先）

**默认备份路径**
```
~/Documents/WeChat_Backup
```

**目录结构**
```
WeChat_Backup/
└── YYYY/
    └── MM/
        ├── Images/
        ├── Videos/
        └── Files/
```

**命名规范**
```
YYYYMMDD_HHMMSS_[type]_[hash].ext
```

**索引清单**
- 生成 `backup-index.csv` / `backup-index.md`
- 记录：原始路径、备份路径、大小、时间、类型

---

## 删除策略（用户确认后）

- 默认只分析，不删除
- 删除前二次确认（输入短语）
- 优先移入废纸篓（非直接删除）
- 输出删除清单（可恢复提示）

---

## 风险提示（默认文案）

- 清理后聊天记录可能显示“图片/视频已过期”
- 建议先备份高价值媒体，再考虑删除
- 可先仅清理“缩略图/临时缓存”

---

## CLI 设计（草案）

```bash
# 默认：只分析 + 报告
python wechat_cleaner.py --analyze

# 生成 Smart Folder 引导
python wechat_cleaner.py --smart-folder

# 备份指定时间段与类型
python wechat_cleaner.py --backup --types image,video --older-than 365

# 删除（需确认）
python wechat_cleaner.py --delete --from-backup
```

---

## 开发优先级

- **P0**：扫描 + 报告 + Smart Folder 引导
- **P1**：备份与组织（含索引清单）
- **P2**：删除流程（确认 + 回收站）

---

**创建日期**: 2026-01-23
**状态**: 规划中
